Outer loop iteration: 1 (seed=41)
sdiff_cons=0.25
INFO - distributed_c10d.py - 2025-10-12 15:25:30,303 - Added key: store_based_barrier_key:1 to store for rank: 0
INFO - distributed_c10d.py - 2025-10-12 15:25:30,304 - Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 1 nodes.
INFO - main_bpda_eot.py - 2025-10-12 15:25:30,357 - Using device: cuda:0
INFO - main_bpda_eot.py - 2025-10-12 15:25:30,357 - Writing log file to logs/CIFAR10/pgd_eot/l-1_512x1_it_20_eot_150_20/model_opt_method_aaopt_total_1_forward_0.25_pur_20/lr_0.1_init_False_lambda_1.0_seed_41
INFO - main_bpda_eot.py - 2025-10-12 15:25:30,357 - Using args: Namespace(log='logs/CIFAR10/pgd_eot/l-1_512x1_it_20_eot_150_20/model_opt_method_aaopt_total_1_forward_0.25_pur_20/lr_0.1_init_False_lambda_1.0_seed_41', config='defalt.yml', seed=41, data_seed=['41'], verbose='info', dataset='CIFAR10', batch_size=8, clf_net='wideresnet-28-10', subset_size=512, purify_iter=20, apprx_iter=1, purify_model='opt', purify_method='aaopt', total_steps=1, forward_steps=0.25, loss_lambda=1.0, lr=0.1, init=False, att_method='pgd_eot', att_lp_norm=-1, att_eps=0.031373, att_step=1, att_n_iter=20, att_alpha=0.00784313725490196, eot_defense_reps=150, eot_attack_reps=20, network_pkl='https://nvlabs-fi-cdn.nvidia.com/edm/pretrained/edm-cifar10-32x32-uncond-vp.pkl', sigma_min=None, sigma_max=None, sdiff_cons=0.25, ex_grad=1, no_stop_grad=0, diff_reversed=1, aa=0, seq_t=0, use_full_steps=0, sdiff_net='./pretrained_models/cifar10_score_DIFF_JOINT_wideresnet-28-10_', use_aa_rand=0, device=device(type='cuda', index=0))
Downloading https://www.cs.toronto.edu/~kriz/cifar-10-python.tar.gz to ./datasets/CIFAR10/cifar-10-python.tar.gz
  0%|          | 0/170498071 [00:00<?, ?it/s]  0%|          | 229376/170498071 [00:00<01:18, 2180092.58it/s]  1%|          | 1081344/170498071 [00:00<00:29, 5809867.27it/s]  1%|          | 2097152/170498071 [00:00<00:21, 7667963.19it/s]  2%|▏         | 3342336/170498071 [00:00<00:17, 9448511.93it/s]  3%|▎         | 4751360/170498071 [00:00<00:14, 11089691.96it/s]  4%|▍         | 6488064/170498071 [00:00<00:12, 13168701.20it/s]  5%|▌         | 8650752/170498071 [00:00<00:10, 15863595.26it/s]  7%|▋         | 11206656/170498071 [00:00<00:08, 18917324.70it/s]  8%|▊         | 14352384/170498071 [00:00<00:06, 22679472.09it/s] 11%|█         | 18120704/170498071 [00:01<00:05, 27244835.19it/s] 13%|█▎        | 22708224/170498071 [00:01<00:04, 32897202.49it/s] 16%|█▋        | 28082176/170498071 [00:01<00:03, 39204260.28it/s] 20%|██        | 34635776/170498071 [00:01<00:02, 47145680.09it/s] 24%|██▍       | 41680896/170498071 [00:01<00:02, 54142776.63it/s] 29%|██▊       | 48660480/170498071 [00:01<00:02, 58802514.76it/s] 33%|███▎      | 55836672/170498071 [00:01<00:01, 62665656.29it/s] 37%|███▋      | 62586880/170498071 [00:01<00:01, 64101624.31it/s] 41%|████      | 69697536/170498071 [00:01<00:01, 66153880.60it/s] 45%|████▌     | 76808192/170498071 [00:01<00:01, 67614658.49it/s] 49%|████▉     | 83853312/170498071 [00:02<00:01, 68364531.21it/s] 53%|█████▎    | 90832896/170498071 [00:02<00:01, 68773062.04it/s] 57%|█████▋    | 98009088/170498071 [00:02<00:01, 69650722.74it/s] 62%|██████▏   | 105218048/170498071 [00:02<00:00, 70207896.37it/s] 66%|██████▌   | 112263168/170498071 [00:02<00:00, 65530486.31it/s] 70%|██████▉   | 118882304/170498071 [00:02<00:00, 54416779.72it/s] 75%|███████▍  | 127139840/170498071 [00:02<00:00, 61433705.18it/s] 79%|███████▊  | 134152192/170498071 [00:02<00:00, 63699860.24it/s] 83%|████████▎ | 140836864/170498071 [00:02<00:00, 63612222.05it/s] 87%|████████▋ | 147718144/170498071 [00:03<00:00, 65009975.74it/s] 91%|█████████ | 154894336/170498071 [00:03<00:00, 66902743.65it/s] 95%|█████████▍| 161710080/170498071 [00:03<00:00, 67142454.55it/s]100%|█████████▉| 169672704/170498071 [00:03<00:00, 70775417.64it/s]100%|██████████| 170498071/170498071 [00:03<00:00, 51070145.33it/s]
Extracting ./datasets/CIFAR10/cifar-10-python.tar.gz to ./datasets/CIFAR10
using cifar10 wideresnet-28-10...
=> loading cifar10-diffusion checkpoint from 'https://nvlabs-fi-cdn.nvidia.com/edm/pretrained/edm-cifar10-32x32-uncond-vp.pkl'
loading perturbation model from provided path:  ./pretrained_models/cifar10_score_DIFF_JOINT_wideresnet-28-10_
perturbation model loaded
EPS:  0.031373
SDIFF:  0.25
BPDA_EOT config: {'eot_defense_ave': 'logits', 'eot_attack_ave': 'logits', 'eot_defense_reps': 150, 'eot_attack_reps': 20, 'adv_steps': 20, 'adv_norm': 'l_inf', 'adv_eps': 0.031373, 'adv_eta': 0.00784325, 'log_freq': 10}
BPDA_EOT tag: True
  0%|          | 0/64 [00:00<?, ?it/s]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 6 of 8
Attack 20 of 20   Batch defended: 6 of 8
finished 1-th batch in attack_all
  2%|▏         | 1/64 [01:20<1:24:31, 80.50s/it]Baseline: 6 of 8
Attack 0 of 20   Batch defended: 6 of 8
Attack 1 of 20   Batch defended: 5 of 8
Attack 10 of 20   Batch defended: 5 of 8
Attack 20 of 20   Batch defended: 5 of 8
finished 2-th batch in attack_all
  3%|▎         | 2/64 [02:45<1:25:41, 82.93s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 3-th batch in attack_all
  5%|▍         | 3/64 [04:00<1:20:52, 79.55s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 4-th batch in attack_all
  6%|▋         | 4/64 [05:19<1:19:10, 79.17s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 5-th batch in attack_all
  8%|▊         | 5/64 [06:34<1:16:33, 77.85s/it]Baseline: 6 of 8
Attack 0 of 20   Batch defended: 6 of 8
Attack 1 of 20   Batch defended: 6 of 8
Attack 10 of 20   Batch defended: 5 of 8
Attack 20 of 20   Batch defended: 5 of 8
finished 6-th batch in attack_all
  9%|▉         | 6/64 [07:56<1:16:30, 79.14s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 7-th batch in attack_all
 11%|█         | 7/64 [09:21<1:16:55, 80.98s/it]Baseline: 5 of 8
Attack 0 of 20   Batch defended: 5 of 8
Attack 1 of 20   Batch defended: 5 of 8
Attack 10 of 20   Batch defended: 5 of 8
Attack 20 of 20   Batch defended: 5 of 8
finished 8-th batch in attack_all
 12%|█▎        | 8/64 [10:42<1:15:47, 81.20s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 9-th batch in attack_all
 14%|█▍        | 9/64 [11:58<1:12:48, 79.43s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 10-th batch in attack_all
 16%|█▌        | 10/64 [13:20<1:12:06, 80.12s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 11-th batch in attack_all
 17%|█▋        | 11/64 [14:54<1:14:31, 84.37s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 12-th batch in attack_all
 19%|█▉        | 12/64 [16:06<1:09:58, 80.74s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 13-th batch in attack_all
 20%|██        | 13/64 [17:58<1:16:47, 90.34s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 14-th batch in attack_all
 22%|██▏       | 14/64 [19:23<1:13:52, 88.65s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 5 of 8
Attack 20 of 20   Batch defended: 5 of 8
finished 15-th batch in attack_all
 23%|██▎       | 15/64 [20:54<1:12:56, 89.33s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 16-th batch in attack_all
 25%|██▌       | 16/64 [22:16<1:09:36, 87.02s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 6 of 8
Attack 1 of 20   Batch defended: 4 of 8
Attack 10 of 20   Batch defended: 4 of 8
Attack 20 of 20   Batch defended: 4 of 8
finished 17-th batch in attack_all
 27%|██▋       | 17/64 [23:44<1:08:21, 87.26s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 18-th batch in attack_all
 28%|██▊       | 18/64 [24:56<1:03:28, 82.79s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 19-th batch in attack_all
 30%|██▉       | 19/64 [26:08<59:45, 79.68s/it]  Baseline: 6 of 8
Attack 0 of 20   Batch defended: 6 of 8
Attack 1 of 20   Batch defended: 6 of 8
Attack 10 of 20   Batch defended: 6 of 8
Attack 20 of 20   Batch defended: 6 of 8
finished 20-th batch in attack_all
 31%|███▏      | 20/64 [27:27<58:11, 79.35s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 21-th batch in attack_all
 33%|███▎      | 21/64 [28:42<56:02, 78.20s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 22-th batch in attack_all
 34%|███▍      | 22/64 [30:04<55:28, 79.24s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 23-th batch in attack_all
 36%|███▌      | 23/64 [31:17<52:45, 77.20s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 24-th batch in attack_all
 38%|███▊      | 24/64 [32:32<51:07, 76.69s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 25-th batch in attack_all
 39%|███▉      | 25/64 [33:45<49:01, 75.42s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 26-th batch in attack_all
 41%|████      | 26/64 [35:00<47:47, 75.46s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 6 of 8
Attack 10 of 20   Batch defended: 5 of 8
Attack 20 of 20   Batch defended: 5 of 8
finished 27-th batch in attack_all
 42%|████▏     | 27/64 [36:31<49:22, 80.08s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 28-th batch in attack_all
 44%|████▍     | 28/64 [37:50<47:46, 79.63s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 6 of 8
Attack 20 of 20   Batch defended: 6 of 8
finished 29-th batch in attack_all
 45%|████▌     | 29/64 [39:14<47:20, 81.16s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 30-th batch in attack_all
 47%|████▋     | 30/64 [40:33<45:33, 80.38s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 31-th batch in attack_all
 48%|████▊     | 31/64 [41:54<44:25, 80.77s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 32-th batch in attack_all
 50%|█████     | 32/64 [43:13<42:43, 80.11s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 33-th batch in attack_all
 52%|█████▏    | 33/64 [44:29<40:40, 78.73s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 34-th batch in attack_all
 53%|█████▎    | 34/64 [45:41<38:25, 76.84s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 35-th batch in attack_all
 55%|█████▍    | 35/64 [46:57<36:56, 76.45s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 36-th batch in attack_all
 56%|█████▋    | 36/64 [48:18<36:24, 78.01s/it]Baseline: 6 of 8
Attack 0 of 20   Batch defended: 6 of 8
Attack 1 of 20   Batch defended: 6 of 8
Attack 10 of 20   Batch defended: 6 of 8
Attack 20 of 20   Batch defended: 6 of 8
finished 37-th batch in attack_all
 58%|█████▊    | 37/64 [49:43<36:00, 80.02s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 38-th batch in attack_all
 59%|█████▉    | 38/64 [50:58<34:05, 78.67s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 39-th batch in attack_all
 61%|██████    | 39/64 [52:17<32:46, 78.64s/it]Baseline: 6 of 8
Attack 0 of 20   Batch defended: 6 of 8
Attack 1 of 20   Batch defended: 6 of 8
Attack 10 of 20   Batch defended: 6 of 8
Attack 20 of 20   Batch defended: 6 of 8
finished 40-th batch in attack_all
 62%|██████▎   | 40/64 [53:36<31:26, 78.62s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 41-th batch in attack_all
 64%|██████▍   | 41/64 [54:51<29:46, 77.68s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 6 of 8
Attack 20 of 20   Batch defended: 6 of 8
finished 42-th batch in attack_all
 66%|██████▌   | 42/64 [56:22<29:56, 81.65s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 43-th batch in attack_all
 67%|██████▋   | 43/64 [57:40<28:15, 80.72s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 44-th batch in attack_all
 69%|██████▉   | 44/64 [58:53<26:04, 78.23s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 45-th batch in attack_all
 70%|███████   | 45/64 [1:00:05<24:13, 76.48s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 46-th batch in attack_all
 72%|███████▏  | 46/64 [1:01:18<22:34, 75.27s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 6 of 8
Attack 10 of 20   Batch defended: 5 of 8
Attack 20 of 20   Batch defended: 5 of 8
finished 47-th batch in attack_all
 73%|███████▎  | 47/64 [1:02:52<22:54, 80.88s/it]Baseline: 6 of 8
Attack 0 of 20   Batch defended: 6 of 8
Attack 1 of 20   Batch defended: 6 of 8
Attack 10 of 20   Batch defended: 6 of 8
Attack 20 of 20   Batch defended: 6 of 8
finished 48-th batch in attack_all
 75%|███████▌  | 48/64 [1:04:10<21:23, 80.19s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 49-th batch in attack_all
 77%|███████▋  | 49/64 [1:05:32<20:09, 80.63s/it]Baseline: 6 of 8
Attack 0 of 20   Batch defended: 6 of 8
Attack 1 of 20   Batch defended: 6 of 8
Attack 10 of 20   Batch defended: 5 of 8
Attack 20 of 20   Batch defended: 5 of 8
finished 50-th batch in attack_all
 78%|███████▊  | 50/64 [1:06:57<19:05, 81.86s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 6 of 8
Attack 1 of 20   Batch defended: 6 of 8
Attack 10 of 20   Batch defended: 6 of 8
Attack 20 of 20   Batch defended: 6 of 8
finished 51-th batch in attack_all
 80%|███████▉  | 51/64 [1:08:28<18:19, 84.56s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 52-th batch in attack_all
 81%|████████▏ | 52/64 [1:09:52<16:55, 84.61s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 53-th batch in attack_all
 83%|████████▎ | 53/64 [1:11:05<14:50, 80.96s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 6 of 8
Attack 10 of 20   Batch defended: 6 of 8
Attack 20 of 20   Batch defended: 6 of 8
finished 54-th batch in attack_all
 84%|████████▍ | 54/64 [1:12:23<13:22, 80.25s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 55-th batch in attack_all
 86%|████████▌ | 55/64 [1:13:39<11:49, 78.83s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 56-th batch in attack_all
 88%|████████▊ | 56/64 [1:14:51<10:15, 76.91s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 57-th batch in attack_all
 89%|████████▉ | 57/64 [1:16:16<09:14, 79.26s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 6 of 8
Attack 1 of 20   Batch defended: 6 of 8
Attack 10 of 20   Batch defended: 6 of 8
Attack 20 of 20   Batch defended: 6 of 8
finished 58-th batch in attack_all
 91%|█████████ | 58/64 [1:17:35<07:54, 79.06s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 59-th batch in attack_all
 92%|█████████▏| 59/64 [1:18:50<06:29, 77.99s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 60-th batch in attack_all
 94%|█████████▍| 60/64 [1:20:09<05:12, 78.16s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 61-th batch in attack_all
 95%|█████████▌| 61/64 [1:21:30<03:57, 79.24s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 62-th batch in attack_all
 97%|█████████▋| 62/64 [1:22:43<02:34, 77.20s/it]Baseline: 6 of 8
Attack 0 of 20   Batch defended: 6 of 8
Attack 1 of 20   Batch defended: 6 of 8
Attack 10 of 20   Batch defended: 6 of 8
Attack 20 of 20   Batch defended: 6 of 8
finished 63-th batch in attack_all
 98%|█████████▊| 63/64 [1:24:01<01:17, 77.62s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 64-th batch in attack_all
100%|██████████| 64/64 [1:25:32<00:00, 81.62s/it]100%|██████████| 64/64 [1:25:33<00:00, 80.20s/it]
Rank: 0, x_adv shape: torch.Size([512, 3, 32, 32])
INFO - main_bpda_eot.py - 2025-10-12 16:51:11,404 - Rank:0
INFO - main_bpda_eot.py - 2025-10-12 16:51:11,404 - standard accuracy: 0.9140625
INFO - main_bpda_eot.py - 2025-10-12 16:51:11,404 - robust accuracy: 0.86328125
INFO - main_bpda_eot.py - 2025-10-12 16:51:11,404 - All gpus
INFO - main_bpda_eot.py - 2025-10-12 16:51:11,404 - standard accuracy: 0.9140625
INFO - main_bpda_eot.py - 2025-10-12 16:51:11,404 - robust accuracy: 0.86328125
INFO - main_bpda_eot.py - 2025-10-12 16:51:11,404 - time elapsed: 5133.01s
Traceback (most recent call last):
  File "/home/dweseg2/t_folder/AAOpt_code/main_bpda_eot.py", line 371, in <module>
    main()
  File "/home/dweseg2/t_folder/AAOpt_code/main_bpda_eot.py", line 351, in main
    df.to_csv(os.path.join("results","{}_{}_l{}_{}x{}_iter_{}_eot_{}_{}_model_{}_method_{}_total_{}_forward_{}_pur_{}_seed_{}.csv").format(
  File "/home/dweseg2/sopt/lib/python3.10/site-packages/pandas/core/generic.py", line 3466, in to_csv
    return DataFrameRenderer(formatter).to_csv(
  File "/home/dweseg2/sopt/lib/python3.10/site-packages/pandas/io/formats/format.py", line 1105, in to_csv
    csv_formatter.save()
  File "/home/dweseg2/sopt/lib/python3.10/site-packages/pandas/io/formats/csvs.py", line 237, in save
    with get_handle(
  File "/home/dweseg2/sopt/lib/python3.10/site-packages/pandas/io/common.py", line 702, in get_handle
    handle = open(
FileNotFoundError: [Errno 2] No such file or directory: 'results/CIFAR10_pgd_eot_l-1_512x1_iter_20_eot_150_20_model_opt_method_aaopt_total_1_forward_0.25_pur_20_seed_41.csv'
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 0 (pid: 1407867) of binary: /home/dweseg2/sopt/bin/python
Traceback (most recent call last):
  File "/home/dweseg2/sopt/bin/torchrun", line 8, in <module>
    sys.exit(main())
  File "/home/dweseg2/sopt/lib/python3.10/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 346, in wrapper
    return f(*args, **kwargs)
  File "/home/dweseg2/sopt/lib/python3.10/site-packages/torch/distributed/run.py", line 794, in main
    run(args)
  File "/home/dweseg2/sopt/lib/python3.10/site-packages/torch/distributed/run.py", line 785, in run
    elastic_launch(
  File "/home/dweseg2/sopt/lib/python3.10/site-packages/torch/distributed/launcher/api.py", line 134, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/dweseg2/sopt/lib/python3.10/site-packages/torch/distributed/launcher/api.py", line 250, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
main_bpda_eot.py FAILED
------------------------------------------------------------
Failures:
  <NO_OTHER_FAILURES>
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2025-10-12_16:51:17
  host      : octopus.cs.uic.edu
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 1407867)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
Done with sdiff_cons=0.25
 
Completed outer loop iteration: 1 (seed=41)
===============================
Outer loop iteration: 2 (seed=42)
sdiff_cons=0.25
INFO - distributed_c10d.py - 2025-10-12 16:51:22,582 - Added key: store_based_barrier_key:1 to store for rank: 0
INFO - distributed_c10d.py - 2025-10-12 16:51:22,582 - Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 1 nodes.
INFO - main_bpda_eot.py - 2025-10-12 16:51:22,636 - Using device: cuda:0
INFO - main_bpda_eot.py - 2025-10-12 16:51:22,636 - Writing log file to logs/CIFAR10/pgd_eot/l-1_512x1_it_20_eot_150_20/model_opt_method_aaopt_total_1_forward_0.25_pur_20/lr_0.1_init_False_lambda_1.0_seed_42
INFO - main_bpda_eot.py - 2025-10-12 16:51:22,636 - Using args: Namespace(log='logs/CIFAR10/pgd_eot/l-1_512x1_it_20_eot_150_20/model_opt_method_aaopt_total_1_forward_0.25_pur_20/lr_0.1_init_False_lambda_1.0_seed_42', config='defalt.yml', seed=42, data_seed=['42'], verbose='info', dataset='CIFAR10', batch_size=8, clf_net='wideresnet-28-10', subset_size=512, purify_iter=20, apprx_iter=1, purify_model='opt', purify_method='aaopt', total_steps=1, forward_steps=0.25, loss_lambda=1.0, lr=0.1, init=False, att_method='pgd_eot', att_lp_norm=-1, att_eps=0.031373, att_step=1, att_n_iter=20, att_alpha=0.00784313725490196, eot_defense_reps=150, eot_attack_reps=20, network_pkl='https://nvlabs-fi-cdn.nvidia.com/edm/pretrained/edm-cifar10-32x32-uncond-vp.pkl', sigma_min=None, sigma_max=None, sdiff_cons=0.25, ex_grad=1, no_stop_grad=0, diff_reversed=1, aa=0, seq_t=0, use_full_steps=0, sdiff_net='./pretrained_models/cifar10_score_DIFF_JOINT_wideresnet-28-10_', use_aa_rand=0, device=device(type='cuda', index=0))
Files already downloaded and verified
using cifar10 wideresnet-28-10...
=> loading cifar10-diffusion checkpoint from 'https://nvlabs-fi-cdn.nvidia.com/edm/pretrained/edm-cifar10-32x32-uncond-vp.pkl'
loading perturbation model from provided path:  ./pretrained_models/cifar10_score_DIFF_JOINT_wideresnet-28-10_
perturbation model loaded
EPS:  0.031373
SDIFF:  0.25
BPDA_EOT config: {'eot_defense_ave': 'logits', 'eot_attack_ave': 'logits', 'eot_defense_reps': 150, 'eot_attack_reps': 20, 'adv_steps': 20, 'adv_norm': 'l_inf', 'adv_eps': 0.031373, 'adv_eta': 0.00784325, 'log_freq': 10}
BPDA_EOT tag: True
  0%|          | 0/64 [00:00<?, ?it/s]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 1-th batch in attack_all
  2%|▏         | 1/64 [01:16<1:20:32, 76.70s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 2-th batch in attack_all
  3%|▎         | 2/64 [02:38<1:22:17, 79.63s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 3-th batch in attack_all
  5%|▍         | 3/64 [03:50<1:17:36, 76.33s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 4-th batch in attack_all
  6%|▋         | 4/64 [05:09<1:17:12, 77.21s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 5-th batch in attack_all
  8%|▊         | 5/64 [06:21<1:14:13, 75.48s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 6 of 8
Attack 1 of 20   Batch defended: 6 of 8
Attack 10 of 20   Batch defended: 5 of 8
Attack 20 of 20   Batch defended: 5 of 8
finished 6-th batch in attack_all
  9%|▉         | 6/64 [07:43<1:14:59, 77.58s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 7-th batch in attack_all
 11%|█         | 7/64 [08:58<1:13:03, 76.90s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 8-th batch in attack_all
 12%|█▎        | 8/64 [10:14<1:11:20, 76.44s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 9-th batch in attack_all
 14%|█▍        | 9/64 [11:29<1:09:47, 76.14s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 10-th batch in attack_all
 16%|█▌        | 10/64 [12:48<1:09:11, 76.88s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 11-th batch in attack_all
 17%|█▋        | 11/64 [14:00<1:06:43, 75.53s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 12-th batch in attack_all
 19%|█▉        | 12/64 [15:19<1:06:15, 76.45s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 6 of 8
Attack 20 of 20   Batch defended: 6 of 8
finished 13-th batch in attack_all
 20%|██        | 13/64 [16:53<1:09:29, 81.76s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 6 of 8
Attack 20 of 20   Batch defended: 6 of 8
finished 14-th batch in attack_all
 22%|██▏       | 14/64 [18:18<1:08:52, 82.64s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 15-th batch in attack_all
 23%|██▎       | 15/64 [19:36<1:06:30, 81.43s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 16-th batch in attack_all
 25%|██▌       | 16/64 [20:52<1:03:42, 79.64s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 17-th batch in attack_all
 27%|██▋       | 17/64 [22:26<1:05:45, 83.95s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 18-th batch in attack_all
 28%|██▊       | 18/64 [24:12<1:09:29, 90.64s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 19-th batch in attack_all
 30%|██▉       | 19/64 [25:24<1:03:52, 85.16s/it]Baseline: 6 of 8
Attack 0 of 20   Batch defended: 6 of 8
Attack 1 of 20   Batch defended: 6 of 8
Attack 10 of 20   Batch defended: 6 of 8
Attack 20 of 20   Batch defended: 6 of 8
finished 20-th batch in attack_all
 31%|███▏      | 20/64 [26:46<1:01:40, 84.11s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 6 of 8
Attack 20 of 20   Batch defended: 6 of 8
finished 21-th batch in attack_all
 33%|███▎      | 21/64 [28:04<59:04, 82.44s/it]  Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 6 of 8
Attack 10 of 20   Batch defended: 6 of 8
Attack 20 of 20   Batch defended: 6 of 8
finished 22-th batch in attack_all
 34%|███▍      | 22/64 [29:32<58:49, 84.04s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 5 of 8
Attack 20 of 20   Batch defended: 5 of 8
finished 23-th batch in attack_all
 36%|███▌      | 23/64 [31:28<1:03:52, 93.47s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 24-th batch in attack_all
 38%|███▊      | 24/64 [32:46<59:19, 88.99s/it]  Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 6 of 8
Attack 20 of 20   Batch defended: 6 of 8
finished 25-th batch in attack_all
 39%|███▉      | 25/64 [34:11<57:00, 87.70s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 26-th batch in attack_all
 41%|████      | 26/64 [35:39<55:33, 87.73s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 27-th batch in attack_all
 42%|████▏     | 27/64 [37:00<52:58, 85.90s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 6 of 8
Attack 1 of 20   Batch defended: 6 of 8
Attack 10 of 20   Batch defended: 6 of 8
Attack 20 of 20   Batch defended: 6 of 8
finished 28-th batch in attack_all
 44%|████▍     | 28/64 [38:22<50:46, 84.62s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 29-th batch in attack_all
 45%|████▌     | 29/64 [39:47<49:22, 84.65s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 30-th batch in attack_all
 47%|████▋     | 30/64 [41:02<46:24, 81.89s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 31-th batch in attack_all
 48%|████▊     | 31/64 [42:18<43:58, 79.96s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 32-th batch in attack_all
 50%|█████     | 32/64 [43:30<41:26, 77.69s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 33-th batch in attack_all
 52%|█████▏    | 33/64 [44:52<40:45, 78.88s/it]Baseline: 5 of 8
Attack 0 of 20   Batch defended: 5 of 8
Attack 1 of 20   Batch defended: 5 of 8
Attack 10 of 20   Batch defended: 5 of 8
Attack 20 of 20   Batch defended: 5 of 8
finished 34-th batch in attack_all
 53%|█████▎    | 34/64 [46:26<41:42, 83.40s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 35-th batch in attack_all
 55%|█████▍    | 35/64 [47:38<38:43, 80.11s/it]Baseline: 5 of 8
Attack 0 of 20   Batch defended: 5 of 8
Attack 1 of 20   Batch defended: 5 of 8
Attack 10 of 20   Batch defended: 4 of 8
Attack 20 of 20   Batch defended: 4 of 8
finished 36-th batch in attack_all
 56%|█████▋    | 36/64 [49:24<41:02, 87.96s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 37-th batch in attack_all
 58%|█████▊    | 37/64 [50:40<37:53, 84.22s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 6 of 8
Attack 10 of 20   Batch defended: 6 of 8
Attack 20 of 20   Batch defended: 6 of 8
finished 38-th batch in attack_all
 59%|█████▉    | 38/64 [51:58<35:45, 82.52s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 39-th batch in attack_all
 61%|██████    | 39/64 [53:14<33:30, 80.41s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 40-th batch in attack_all
 62%|██████▎   | 40/64 [54:29<31:34, 78.92s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 41-th batch in attack_all
 64%|██████▍   | 41/64 [55:48<30:12, 78.82s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 42-th batch in attack_all
 66%|██████▌   | 42/64 [57:13<29:32, 80.59s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 43-th batch in attack_all
 67%|██████▋   | 43/64 [58:37<28:38, 81.82s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 44-th batch in attack_all
 69%|██████▉   | 44/64 [59:50<26:19, 79.00s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 45-th batch in attack_all
 70%|███████   | 45/64 [1:01:05<24:40, 77.94s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 6 of 8
Attack 20 of 20   Batch defended: 6 of 8
finished 46-th batch in attack_all
 72%|███████▏  | 46/64 [1:02:39<24:49, 82.74s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 47-th batch in attack_all
 73%|███████▎  | 47/64 [1:03:52<22:34, 79.65s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 48-th batch in attack_all
 75%|███████▌  | 48/64 [1:05:07<20:54, 78.41s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 49-th batch in attack_all
 77%|███████▋  | 49/64 [1:06:23<19:23, 77.54s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 50-th batch in attack_all
 78%|███████▊  | 50/64 [1:07:35<17:44, 76.02s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 51-th batch in attack_all
 80%|███████▉  | 51/64 [1:08:51<16:26, 75.87s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 6 of 8
Attack 20 of 20   Batch defended: 6 of 8
finished 52-th batch in attack_all
 81%|████████▏ | 52/64 [1:10:22<16:04, 80.37s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 53-th batch in attack_all
 83%|████████▎ | 53/64 [1:11:40<14:38, 79.84s/it]Baseline: 5 of 8
Attack 0 of 20   Batch defended: 5 of 8
Attack 1 of 20   Batch defended: 5 of 8
Attack 10 of 20   Batch defended: 5 of 8
Attack 20 of 20   Batch defended: 5 of 8
finished 54-th batch in attack_all
 84%|████████▍ | 54/64 [1:13:02<13:23, 80.38s/it]Baseline: 6 of 8
Attack 0 of 20   Batch defended: 6 of 8
Attack 1 of 20   Batch defended: 6 of 8
Attack 10 of 20   Batch defended: 6 of 8
Attack 20 of 20   Batch defended: 5 of 8
finished 55-th batch in attack_all
 86%|████████▌ | 55/64 [1:14:30<12:23, 82.61s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 56-th batch in attack_all
 88%|████████▊ | 56/64 [1:15:51<10:58, 82.32s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 57-th batch in attack_all
 89%|████████▉ | 57/64 [1:17:10<09:28, 81.19s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 58-th batch in attack_all
 91%|█████████ | 58/64 [1:18:22<07:51, 78.55s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 59-th batch in attack_all
 92%|█████████▏| 59/64 [1:19:38<06:28, 77.64s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 60-th batch in attack_all
 94%|█████████▍| 60/64 [1:20:53<05:08, 77.05s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 61-th batch in attack_all
 95%|█████████▌| 61/64 [1:22:12<03:52, 77.51s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 62-th batch in attack_all
 97%|█████████▋| 62/64 [1:23:43<02:43, 81.51s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 6 of 8
Attack 20 of 20   Batch defended: 6 of 8
finished 63-th batch in attack_all
 98%|█████████▊| 63/64 [1:25:01<01:20, 80.63s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 64-th batch in attack_all
100%|██████████| 64/64 [1:26:14<00:00, 78.17s/it]100%|██████████| 64/64 [1:26:14<00:00, 80.85s/it]
Rank: 0, x_adv shape: torch.Size([512, 3, 32, 32])
INFO - main_bpda_eot.py - 2025-10-12 18:17:39,878 - Rank:0
INFO - main_bpda_eot.py - 2025-10-12 18:17:39,878 - standard accuracy: 0.91796875
INFO - main_bpda_eot.py - 2025-10-12 18:17:39,878 - robust accuracy: 0.8671875
INFO - main_bpda_eot.py - 2025-10-12 18:17:39,878 - All gpus
INFO - main_bpda_eot.py - 2025-10-12 18:17:39,879 - standard accuracy: 0.91796875
INFO - main_bpda_eot.py - 2025-10-12 18:17:39,879 - robust accuracy: 0.8671875
INFO - main_bpda_eot.py - 2025-10-12 18:17:39,879 - time elapsed: 5174.37s
Traceback (most recent call last):
  File "/home/dweseg2/t_folder/AAOpt_code/main_bpda_eot.py", line 371, in <module>
    main()
  File "/home/dweseg2/t_folder/AAOpt_code/main_bpda_eot.py", line 351, in main
    df.to_csv(os.path.join("results","{}_{}_l{}_{}x{}_iter_{}_eot_{}_{}_model_{}_method_{}_total_{}_forward_{}_pur_{}_seed_{}.csv").format(
  File "/home/dweseg2/sopt/lib/python3.10/site-packages/pandas/core/generic.py", line 3466, in to_csv
    return DataFrameRenderer(formatter).to_csv(
  File "/home/dweseg2/sopt/lib/python3.10/site-packages/pandas/io/formats/format.py", line 1105, in to_csv
    csv_formatter.save()
  File "/home/dweseg2/sopt/lib/python3.10/site-packages/pandas/io/formats/csvs.py", line 237, in save
    with get_handle(
  File "/home/dweseg2/sopt/lib/python3.10/site-packages/pandas/io/common.py", line 702, in get_handle
    handle = open(
FileNotFoundError: [Errno 2] No such file or directory: 'results/CIFAR10_pgd_eot_l-1_512x1_iter_20_eot_150_20_model_opt_method_aaopt_total_1_forward_0.25_pur_20_seed_42.csv'
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 0 (pid: 1433663) of binary: /home/dweseg2/sopt/bin/python
Traceback (most recent call last):
  File "/home/dweseg2/sopt/bin/torchrun", line 8, in <module>
    sys.exit(main())
  File "/home/dweseg2/sopt/lib/python3.10/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 346, in wrapper
    return f(*args, **kwargs)
  File "/home/dweseg2/sopt/lib/python3.10/site-packages/torch/distributed/run.py", line 794, in main
    run(args)
  File "/home/dweseg2/sopt/lib/python3.10/site-packages/torch/distributed/run.py", line 785, in run
    elastic_launch(
  File "/home/dweseg2/sopt/lib/python3.10/site-packages/torch/distributed/launcher/api.py", line 134, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/dweseg2/sopt/lib/python3.10/site-packages/torch/distributed/launcher/api.py", line 250, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
main_bpda_eot.py FAILED
------------------------------------------------------------
Failures:
  <NO_OTHER_FAILURES>
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2025-10-12_18:17:44
  host      : octopus.cs.uic.edu
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 1433663)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
Done with sdiff_cons=0.25
 
Completed outer loop iteration: 2 (seed=42)
===============================
Outer loop iteration: 3 (seed=43)
sdiff_cons=0.25
INFO - distributed_c10d.py - 2025-10-12 18:17:49,507 - Added key: store_based_barrier_key:1 to store for rank: 0
INFO - distributed_c10d.py - 2025-10-12 18:17:49,507 - Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 1 nodes.
INFO - main_bpda_eot.py - 2025-10-12 18:17:49,560 - Using device: cuda:0
INFO - main_bpda_eot.py - 2025-10-12 18:17:49,561 - Writing log file to logs/CIFAR10/pgd_eot/l-1_512x1_it_20_eot_150_20/model_opt_method_aaopt_total_1_forward_0.25_pur_20/lr_0.1_init_False_lambda_1.0_seed_43
INFO - main_bpda_eot.py - 2025-10-12 18:17:49,561 - Using args: Namespace(log='logs/CIFAR10/pgd_eot/l-1_512x1_it_20_eot_150_20/model_opt_method_aaopt_total_1_forward_0.25_pur_20/lr_0.1_init_False_lambda_1.0_seed_43', config='defalt.yml', seed=43, data_seed=['43'], verbose='info', dataset='CIFAR10', batch_size=8, clf_net='wideresnet-28-10', subset_size=512, purify_iter=20, apprx_iter=1, purify_model='opt', purify_method='aaopt', total_steps=1, forward_steps=0.25, loss_lambda=1.0, lr=0.1, init=False, att_method='pgd_eot', att_lp_norm=-1, att_eps=0.031373, att_step=1, att_n_iter=20, att_alpha=0.00784313725490196, eot_defense_reps=150, eot_attack_reps=20, network_pkl='https://nvlabs-fi-cdn.nvidia.com/edm/pretrained/edm-cifar10-32x32-uncond-vp.pkl', sigma_min=None, sigma_max=None, sdiff_cons=0.25, ex_grad=1, no_stop_grad=0, diff_reversed=1, aa=0, seq_t=0, use_full_steps=0, sdiff_net='./pretrained_models/cifar10_score_DIFF_JOINT_wideresnet-28-10_', use_aa_rand=0, device=device(type='cuda', index=0))
Files already downloaded and verified
using cifar10 wideresnet-28-10...
=> loading cifar10-diffusion checkpoint from 'https://nvlabs-fi-cdn.nvidia.com/edm/pretrained/edm-cifar10-32x32-uncond-vp.pkl'
loading perturbation model from provided path:  ./pretrained_models/cifar10_score_DIFF_JOINT_wideresnet-28-10_
perturbation model loaded
EPS:  0.031373
SDIFF:  0.25
BPDA_EOT config: {'eot_defense_ave': 'logits', 'eot_attack_ave': 'logits', 'eot_defense_reps': 150, 'eot_attack_reps': 20, 'adv_steps': 20, 'adv_norm': 'l_inf', 'adv_eps': 0.031373, 'adv_eta': 0.00784325, 'log_freq': 10}
BPDA_EOT tag: True
  0%|          | 0/64 [00:00<?, ?it/s]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 1-th batch in attack_all
  2%|▏         | 1/64 [01:29<1:33:27, 89.02s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 2-th batch in attack_all
  3%|▎         | 2/64 [02:44<1:23:46, 81.06s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 3-th batch in attack_all
  5%|▍         | 3/64 [04:06<1:22:41, 81.34s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 4-th batch in attack_all
  6%|▋         | 4/64 [05:21<1:19:02, 79.04s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 5-th batch in attack_all
  8%|▊         | 5/64 [06:34<1:15:22, 76.65s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 6-th batch in attack_all
  9%|▉         | 6/64 [07:49<1:13:42, 76.26s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 7-th batch in attack_all
 11%|█         | 7/64 [09:02<1:11:15, 75.00s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 8-th batch in attack_all
 12%|█▎        | 8/64 [10:14<1:09:14, 74.19s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 9-th batch in attack_all
 14%|█▍        | 9/64 [11:29<1:08:23, 74.61s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 10-th batch in attack_all
 16%|█▌        | 10/64 [12:45<1:07:23, 74.89s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 11-th batch in attack_all
 17%|█▋        | 11/64 [14:04<1:07:08, 76.02s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 5 of 8
Attack 20 of 20   Batch defended: 5 of 8
finished 12-th batch in attack_all
 19%|█▉        | 12/64 [15:38<1:10:37, 81.48s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 13-th batch in attack_all
 20%|██        | 13/64 [16:53<1:07:43, 79.67s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 14-th batch in attack_all
 22%|██▏       | 14/64 [18:39<1:13:05, 87.71s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 15-th batch in attack_all
 23%|██▎       | 15/64 [19:58<1:09:23, 84.96s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 16-th batch in attack_all
 25%|██▌       | 16/64 [21:41<1:12:22, 90.46s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 17-th batch in attack_all
 27%|██▋       | 17/64 [22:57<1:07:20, 85.97s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 18-th batch in attack_all
 28%|██▊       | 18/64 [24:09<1:02:47, 81.90s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 19-th batch in attack_all
 30%|██▉       | 19/64 [25:37<1:02:45, 83.68s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 6 of 8
Attack 10 of 20   Batch defended: 6 of 8
Attack 20 of 20   Batch defended: 6 of 8
finished 20-th batch in attack_all
 31%|███▏      | 20/64 [26:56<1:00:14, 82.15s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 21-th batch in attack_all
 33%|███▎      | 21/64 [28:11<57:27, 80.17s/it]  Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 6 of 8
Attack 20 of 20   Batch defended: 6 of 8
finished 22-th batch in attack_all
 34%|███▍      | 22/64 [29:36<57:04, 81.54s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 6 of 8
Attack 10 of 20   Batch defended: 6 of 8
Attack 20 of 20   Batch defended: 6 of 8
finished 23-th batch in attack_all
 36%|███▌      | 23/64 [30:57<55:44, 81.57s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 24-th batch in attack_all
 38%|███▊      | 24/64 [32:13<53:10, 79.75s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 25-th batch in attack_all
 39%|███▉      | 25/64 [33:25<50:24, 77.56s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 26-th batch in attack_all
 41%|████      | 26/64 [34:38<48:09, 76.03s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 27-th batch in attack_all
 42%|████▏     | 27/64 [36:12<50:12, 81.42s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 28-th batch in attack_all
 44%|████▍     | 28/64 [37:34<48:53, 81.50s/it]Baseline: 6 of 8
Attack 0 of 20   Batch defended: 6 of 8
Attack 1 of 20   Batch defended: 6 of 8
Attack 10 of 20   Batch defended: 6 of 8
Attack 20 of 20   Batch defended: 6 of 8
finished 29-th batch in attack_all
 45%|████▌     | 29/64 [39:01<48:38, 83.40s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 6 of 8
Attack 1 of 20   Batch defended: 5 of 8
Attack 10 of 20   Batch defended: 5 of 8
Attack 20 of 20   Batch defended: 5 of 8
finished 30-th batch in attack_all
 47%|████▋     | 30/64 [40:29<48:00, 84.72s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 31-th batch in attack_all
 48%|████▊     | 31/64 [41:42<44:34, 81.04s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 32-th batch in attack_all
 50%|█████     | 32/64 [42:57<42:20, 79.38s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 6 of 8
Attack 20 of 20   Batch defended: 6 of 8
finished 33-th batch in attack_all
 52%|█████▏    | 33/64 [44:25<42:19, 81.92s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 6 of 8
Attack 20 of 20   Batch defended: 6 of 8
finished 34-th batch in attack_all
 53%|█████▎    | 34/64 [45:47<40:55, 81.84s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 35-th batch in attack_all
 55%|█████▍    | 35/64 [46:59<38:11, 79.02s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 36-th batch in attack_all
 56%|█████▋    | 36/64 [48:15<36:23, 77.97s/it]Baseline: 6 of 8
Attack 0 of 20   Batch defended: 6 of 8
Attack 1 of 20   Batch defended: 6 of 8
Attack 10 of 20   Batch defended: 6 of 8
Attack 20 of 20   Batch defended: 6 of 8
finished 37-th batch in attack_all
 58%|█████▊    | 37/64 [49:33<35:10, 78.15s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 38-th batch in attack_all
 59%|█████▉    | 38/64 [50:46<33:07, 76.43s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 6 of 8
Attack 10 of 20   Batch defended: 6 of 8
Attack 20 of 20   Batch defended: 6 of 8
finished 39-th batch in attack_all
 61%|██████    | 39/64 [52:04<32:06, 77.08s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 40-th batch in attack_all
 62%|██████▎   | 40/64 [53:17<30:16, 75.68s/it]Baseline: 6 of 8
Attack 0 of 20   Batch defended: 5 of 8
Attack 1 of 20   Batch defended: 5 of 8
Attack 10 of 20   Batch defended: 5 of 8
Attack 20 of 20   Batch defended: 5 of 8
finished 41-th batch in attack_all
 64%|██████▍   | 41/64 [54:38<29:41, 77.48s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 42-th batch in attack_all
 66%|██████▌   | 42/64 [56:00<28:52, 78.73s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 43-th batch in attack_all
 67%|██████▋   | 43/64 [57:12<26:53, 76.83s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 44-th batch in attack_all
 69%|██████▉   | 44/64 [58:43<27:00, 81.05s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 45-th batch in attack_all
 70%|███████   | 45/64 [59:59<25:08, 79.38s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 46-th batch in attack_all
 72%|███████▏  | 46/64 [1:01:11<23:11, 77.30s/it]Baseline: 6 of 8
Attack 0 of 20   Batch defended: 6 of 8
Attack 1 of 20   Batch defended: 6 of 8
Attack 10 of 20   Batch defended: 6 of 8
Attack 20 of 20   Batch defended: 6 of 8
finished 47-th batch in attack_all
 73%|███████▎  | 47/64 [1:02:30<22:00, 77.69s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 48-th batch in attack_all
 75%|███████▌  | 48/64 [1:03:42<20:17, 76.11s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 6 of 8
Attack 1 of 20   Batch defended: 6 of 8
Attack 10 of 20   Batch defended: 5 of 8
Attack 20 of 20   Batch defended: 5 of 8
finished 49-th batch in attack_all
 77%|███████▋  | 49/64 [1:05:07<19:40, 78.69s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 50-th batch in attack_all
 78%|███████▊  | 50/64 [1:06:22<18:08, 77.73s/it]Baseline: 6 of 8
Attack 0 of 20   Batch defended: 6 of 8
Attack 1 of 20   Batch defended: 6 of 8
Attack 10 of 20   Batch defended: 6 of 8
Attack 20 of 20   Batch defended: 6 of 8
finished 51-th batch in attack_all
 80%|███████▉  | 51/64 [1:07:44<17:05, 78.90s/it]Baseline: 6 of 8
Attack 0 of 20   Batch defended: 6 of 8
Attack 1 of 20   Batch defended: 6 of 8
Attack 10 of 20   Batch defended: 6 of 8
Attack 20 of 20   Batch defended: 6 of 8
finished 52-th batch in attack_all
 81%|████████▏ | 52/64 [1:09:06<15:56, 79.73s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 5 of 8
Attack 20 of 20   Batch defended: 5 of 8
finished 53-th batch in attack_all
 83%|████████▎ | 53/64 [1:10:34<15:03, 82.15s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 54-th batch in attack_all
 84%|████████▍ | 54/64 [1:11:46<13:12, 79.24s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 6 of 8
Attack 1 of 20   Batch defended: 6 of 8
Attack 10 of 20   Batch defended: 6 of 8
Attack 20 of 20   Batch defended: 6 of 8
finished 55-th batch in attack_all
 86%|████████▌ | 55/64 [1:13:08<11:59, 79.97s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 56-th batch in attack_all
 88%|████████▊ | 56/64 [1:14:20<10:21, 77.70s/it]Baseline: 6 of 8
Attack 0 of 20   Batch defended: 5 of 8
Attack 1 of 20   Batch defended: 5 of 8
Attack 10 of 20   Batch defended: 5 of 8
Attack 20 of 20   Batch defended: 5 of 8
finished 57-th batch in attack_all
 89%|████████▉ | 57/64 [1:15:42<09:12, 78.88s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 6 of 8
finished 58-th batch in attack_all
 91%|█████████ | 58/64 [1:17:09<08:09, 81.56s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 59-th batch in attack_all
 92%|█████████▏| 59/64 [1:18:25<06:38, 79.74s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 60-th batch in attack_all
 94%|█████████▍| 60/64 [1:19:41<05:14, 78.53s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 61-th batch in attack_all
 95%|█████████▌| 61/64 [1:20:59<03:55, 78.55s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 62-th batch in attack_all
 97%|█████████▋| 62/64 [1:22:18<02:37, 78.56s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 63-th batch in attack_all
 98%|█████████▊| 63/64 [1:23:30<01:16, 76.72s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 64-th batch in attack_all
100%|██████████| 64/64 [1:24:46<00:00, 76.35s/it]100%|██████████| 64/64 [1:24:46<00:00, 79.47s/it]
Rank: 0, x_adv shape: torch.Size([512, 3, 32, 32])
INFO - main_bpda_eot.py - 2025-10-12 19:42:38,893 - Rank:0
INFO - main_bpda_eot.py - 2025-10-12 19:42:38,893 - standard accuracy: 0.91796875
INFO - main_bpda_eot.py - 2025-10-12 19:42:38,893 - robust accuracy: 0.86328125
INFO - main_bpda_eot.py - 2025-10-12 19:42:38,893 - All gpus
INFO - main_bpda_eot.py - 2025-10-12 19:42:38,893 - standard accuracy: 0.91796875
INFO - main_bpda_eot.py - 2025-10-12 19:42:38,893 - robust accuracy: 0.86328125
INFO - main_bpda_eot.py - 2025-10-12 19:42:38,893 - time elapsed: 5086.38s
Done with sdiff_cons=0.25
 
Completed outer loop iteration: 3 (seed=43)
===============================
Outer loop iteration: 4 (seed=44)
sdiff_cons=0.25
INFO - distributed_c10d.py - 2025-10-12 19:42:46,541 - Added key: store_based_barrier_key:1 to store for rank: 0
INFO - distributed_c10d.py - 2025-10-12 19:42:46,541 - Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 1 nodes.
INFO - main_bpda_eot.py - 2025-10-12 19:42:46,598 - Using device: cuda:0
INFO - main_bpda_eot.py - 2025-10-12 19:42:46,598 - Writing log file to logs/CIFAR10/pgd_eot/l-1_512x1_it_20_eot_150_20/model_opt_method_aaopt_total_1_forward_0.25_pur_20/lr_0.1_init_False_lambda_1.0_seed_44
INFO - main_bpda_eot.py - 2025-10-12 19:42:46,598 - Using args: Namespace(log='logs/CIFAR10/pgd_eot/l-1_512x1_it_20_eot_150_20/model_opt_method_aaopt_total_1_forward_0.25_pur_20/lr_0.1_init_False_lambda_1.0_seed_44', config='defalt.yml', seed=44, data_seed=['44'], verbose='info', dataset='CIFAR10', batch_size=8, clf_net='wideresnet-28-10', subset_size=512, purify_iter=20, apprx_iter=1, purify_model='opt', purify_method='aaopt', total_steps=1, forward_steps=0.25, loss_lambda=1.0, lr=0.1, init=False, att_method='pgd_eot', att_lp_norm=-1, att_eps=0.031373, att_step=1, att_n_iter=20, att_alpha=0.00784313725490196, eot_defense_reps=150, eot_attack_reps=20, network_pkl='https://nvlabs-fi-cdn.nvidia.com/edm/pretrained/edm-cifar10-32x32-uncond-vp.pkl', sigma_min=None, sigma_max=None, sdiff_cons=0.25, ex_grad=1, no_stop_grad=0, diff_reversed=1, aa=0, seq_t=0, use_full_steps=0, sdiff_net='./pretrained_models/cifar10_score_DIFF_JOINT_wideresnet-28-10_', use_aa_rand=0, device=device(type='cuda', index=0))
Files already downloaded and verified
using cifar10 wideresnet-28-10...
=> loading cifar10-diffusion checkpoint from 'https://nvlabs-fi-cdn.nvidia.com/edm/pretrained/edm-cifar10-32x32-uncond-vp.pkl'
loading perturbation model from provided path:  ./pretrained_models/cifar10_score_DIFF_JOINT_wideresnet-28-10_
perturbation model loaded
EPS:  0.031373
SDIFF:  0.25
BPDA_EOT config: {'eot_defense_ave': 'logits', 'eot_attack_ave': 'logits', 'eot_defense_reps': 150, 'eot_attack_reps': 20, 'adv_steps': 20, 'adv_norm': 'l_inf', 'adv_eps': 0.031373, 'adv_eta': 0.00784325, 'log_freq': 10}
BPDA_EOT tag: True
  0%|          | 0/64 [00:00<?, ?it/s]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 1-th batch in attack_all
  2%|▏         | 1/64 [01:13<1:17:22, 73.69s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 2-th batch in attack_all
  3%|▎         | 2/64 [02:26<1:15:22, 72.94s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 3-th batch in attack_all
  5%|▍         | 3/64 [04:30<1:38:13, 96.61s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 4-th batch in attack_all
  6%|▋         | 4/64 [06:01<1:34:21, 94.36s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 5-th batch in attack_all
  8%|▊         | 5/64 [07:14<1:25:00, 86.46s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 6-th batch in attack_all
  9%|▉         | 6/64 [08:51<1:27:02, 90.05s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 6 of 8
Attack 1 of 20   Batch defended: 6 of 8
Attack 10 of 20   Batch defended: 5 of 8
Attack 20 of 20   Batch defended: 5 of 8
finished 7-th batch in attack_all
 11%|█         | 7/64 [10:12<1:22:56, 87.31s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 6 of 8
Attack 20 of 20   Batch defended: 6 of 8
finished 8-th batch in attack_all
 12%|█▎        | 8/64 [11:46<1:23:27, 89.42s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 9-th batch in attack_all
 14%|█▍        | 9/64 [12:59<1:17:06, 84.11s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 6 of 8
Attack 20 of 20   Batch defended: 6 of 8
finished 10-th batch in attack_all
 16%|█▌        | 10/64 [14:20<1:15:01, 83.36s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 11-th batch in attack_all
 17%|█▋        | 11/64 [15:39<1:12:20, 81.90s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 12-th batch in attack_all
 19%|█▉        | 12/64 [17:19<1:15:46, 87.44s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 13-th batch in attack_all
 20%|██        | 13/64 [18:41<1:12:50, 85.69s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 14-th batch in attack_all
 22%|██▏       | 14/64 [20:12<1:12:42, 87.26s/it]Baseline: 6 of 8
Attack 0 of 20   Batch defended: 6 of 8
Attack 1 of 20   Batch defended: 6 of 8
Attack 10 of 20   Batch defended: 6 of 8
Attack 20 of 20   Batch defended: 6 of 8
finished 15-th batch in attack_all
 23%|██▎       | 15/64 [21:30<1:09:07, 84.63s/it]Baseline: 6 of 8
Attack 0 of 20   Batch defended: 6 of 8
Attack 1 of 20   Batch defended: 6 of 8
Attack 10 of 20   Batch defended: 6 of 8
Attack 20 of 20   Batch defended: 6 of 8
finished 16-th batch in attack_all
 25%|██▌       | 16/64 [22:49<1:06:14, 82.81s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 17-th batch in attack_all
 27%|██▋       | 17/64 [24:10<1:04:35, 82.46s/it]Baseline: 6 of 8
Attack 0 of 20   Batch defended: 6 of 8
Attack 1 of 20   Batch defended: 5 of 8
Attack 10 of 20   Batch defended: 5 of 8
Attack 20 of 20   Batch defended: 5 of 8
finished 18-th batch in attack_all
 28%|██▊       | 18/64 [25:32<1:03:02, 82.23s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 6 of 8
Attack 20 of 20   Batch defended: 6 of 8
finished 19-th batch in attack_all
 30%|██▉       | 19/64 [27:09<1:05:01, 86.69s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 20-th batch in attack_all
 31%|███▏      | 20/64 [28:25<1:01:06, 83.34s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 21-th batch in attack_all
 33%|███▎      | 21/64 [29:40<58:02, 80.98s/it]  Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 22-th batch in attack_all
 34%|███▍      | 22/64 [30:56<55:32, 79.35s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 23-th batch in attack_all
 36%|███▌      | 23/64 [32:51<1:01:38, 90.20s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 24-th batch in attack_all
 38%|███▊      | 24/64 [34:07<57:11, 85.79s/it]  Baseline: 5 of 8
Attack 0 of 20   Batch defended: 5 of 8
Attack 1 of 20   Batch defended: 5 of 8
Attack 10 of 20   Batch defended: 5 of 8
Attack 20 of 20   Batch defended: 5 of 8
finished 25-th batch in attack_all
 39%|███▉      | 25/64 [35:28<54:57, 84.54s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 26-th batch in attack_all
 41%|████      | 26/64 [36:50<52:59, 83.68s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 27-th batch in attack_all
 42%|████▏     | 27/64 [38:03<49:31, 80.30s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 28-th batch in attack_all
 44%|████▍     | 28/64 [39:18<47:18, 78.86s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 29-th batch in attack_all
 45%|████▌     | 29/64 [40:31<44:53, 76.94s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 30-th batch in attack_all
 47%|████▋     | 30/64 [41:55<44:55, 79.28s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 31-th batch in attack_all
 48%|████▊     | 31/64 [43:11<42:58, 78.15s/it]Baseline: 6 of 8
Attack 0 of 20   Batch defended: 6 of 8
Attack 1 of 20   Batch defended: 6 of 8
Attack 10 of 20   Batch defended: 6 of 8
Attack 20 of 20   Batch defended: 6 of 8
finished 32-th batch in attack_all
 50%|█████     | 32/64 [44:29<41:44, 78.27s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 33-th batch in attack_all
 52%|█████▏    | 33/64 [45:48<40:29, 78.36s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 34-th batch in attack_all
 53%|█████▎    | 34/64 [47:03<38:45, 77.51s/it]Baseline: 6 of 8
Attack 0 of 20   Batch defended: 6 of 8
Attack 1 of 20   Batch defended: 6 of 8
Attack 10 of 20   Batch defended: 6 of 8
Attack 20 of 20   Batch defended: 6 of 8
finished 35-th batch in attack_all
 55%|█████▍    | 35/64 [48:31<38:57, 80.60s/it]Baseline: 6 of 8
Attack 0 of 20   Batch defended: 6 of 8
Attack 1 of 20   Batch defended: 6 of 8
Attack 10 of 20   Batch defended: 6 of 8
Attack 20 of 20   Batch defended: 6 of 8
finished 36-th batch in attack_all
 56%|█████▋    | 36/64 [49:50<37:19, 79.99s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 37-th batch in attack_all
 58%|█████▊    | 37/64 [51:05<35:23, 78.64s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 38-th batch in attack_all
 59%|█████▉    | 38/64 [52:18<33:16, 76.78s/it]Baseline: 6 of 8
Attack 0 of 20   Batch defended: 6 of 8
Attack 1 of 20   Batch defended: 5 of 8
Attack 10 of 20   Batch defended: 4 of 8
Attack 20 of 20   Batch defended: 4 of 8
finished 39-th batch in attack_all
 61%|██████    | 39/64 [53:55<34:31, 82.85s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 40-th batch in attack_all
 62%|██████▎   | 40/64 [55:13<32:37, 81.57s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 41-th batch in attack_all
 64%|██████▍   | 41/64 [56:29<30:34, 79.75s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 42-th batch in attack_all
 66%|██████▌   | 42/64 [57:41<28:25, 77.54s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 6 of 8
Attack 10 of 20   Batch defended: 5 of 8
Attack 20 of 20   Batch defended: 5 of 8
finished 43-th batch in attack_all
 67%|██████▋   | 43/64 [59:03<27:34, 78.77s/it]Baseline: 6 of 8
Attack 0 of 20   Batch defended: 6 of 8
Attack 1 of 20   Batch defended: 6 of 8
Attack 10 of 20   Batch defended: 6 of 8
Attack 20 of 20   Batch defended: 6 of 8
finished 44-th batch in attack_all
 69%|██████▉   | 44/64 [1:00:21<26:14, 78.71s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 45-th batch in attack_all
 70%|███████   | 45/64 [1:01:34<24:19, 76.82s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 46-th batch in attack_all
 72%|███████▏  | 46/64 [1:02:49<22:55, 76.43s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 6 of 8
finished 47-th batch in attack_all
 73%|███████▎  | 47/64 [1:04:20<22:53, 80.77s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 48-th batch in attack_all
 75%|███████▌  | 48/64 [1:05:48<22:06, 82.88s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 49-th batch in attack_all
 77%|███████▋  | 49/64 [1:07:00<19:56, 79.75s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 50-th batch in attack_all
 78%|███████▊  | 50/64 [1:08:22<18:44, 80.33s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 51-th batch in attack_all
 80%|███████▉  | 51/64 [1:09:38<17:05, 78.89s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 52-th batch in attack_all
 81%|████████▏ | 52/64 [1:10:53<15:34, 77.89s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 53-th batch in attack_all
 83%|████████▎ | 53/64 [1:12:06<13:58, 76.27s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 54-th batch in attack_all
 84%|████████▍ | 54/64 [1:13:31<13:08, 78.84s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 6 of 8
Attack 20 of 20   Batch defended: 6 of 8
finished 55-th batch in attack_all
 86%|████████▌ | 55/64 [1:14:49<11:49, 78.78s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 6 of 8
Attack 20 of 20   Batch defended: 6 of 8
finished 56-th batch in attack_all
 88%|████████▊ | 56/64 [1:16:20<10:59, 82.43s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 57-th batch in attack_all
 89%|████████▉ | 57/64 [1:17:33<09:16, 79.45s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 58-th batch in attack_all
 91%|█████████ | 58/64 [1:18:57<08:06, 81.06s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 59-th batch in attack_all
 92%|█████████▏| 59/64 [1:20:16<06:41, 80.38s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 60-th batch in attack_all
 94%|█████████▍| 60/64 [1:21:47<05:34, 83.55s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 61-th batch in attack_all
 95%|█████████▌| 61/64 [1:23:00<04:00, 80.23s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 62-th batch in attack_all
 97%|█████████▋| 62/64 [1:24:15<02:37, 78.83s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 63-th batch in attack_all
 98%|█████████▊| 63/64 [1:25:34<01:18, 78.77s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 64-th batch in attack_all
100%|██████████| 64/64 [1:26:49<00:00, 77.80s/it]100%|██████████| 64/64 [1:26:50<00:00, 81.41s/it]
Rank: 0, x_adv shape: torch.Size([512, 3, 32, 32])
INFO - main_bpda_eot.py - 2025-10-12 21:09:39,535 - Rank:0
INFO - main_bpda_eot.py - 2025-10-12 21:09:39,536 - standard accuracy: 0.93359375
INFO - main_bpda_eot.py - 2025-10-12 21:09:39,536 - robust accuracy: 0.880859375
INFO - main_bpda_eot.py - 2025-10-12 21:09:39,536 - All gpus
INFO - main_bpda_eot.py - 2025-10-12 21:09:39,536 - standard accuracy: 0.93359375
INFO - main_bpda_eot.py - 2025-10-12 21:09:39,536 - robust accuracy: 0.880859375
INFO - main_bpda_eot.py - 2025-10-12 21:09:39,536 - time elapsed: 5210.07s
Done with sdiff_cons=0.25
 
Completed outer loop iteration: 4 (seed=44)
===============================
Outer loop iteration: 5 (seed=45)
sdiff_cons=0.25
INFO - distributed_c10d.py - 2025-10-12 21:09:48,790 - Added key: store_based_barrier_key:1 to store for rank: 0
INFO - distributed_c10d.py - 2025-10-12 21:09:48,791 - Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 1 nodes.
INFO - main_bpda_eot.py - 2025-10-12 21:09:48,844 - Using device: cuda:0
INFO - main_bpda_eot.py - 2025-10-12 21:09:48,844 - Writing log file to logs/CIFAR10/pgd_eot/l-1_512x1_it_20_eot_150_20/model_opt_method_aaopt_total_1_forward_0.25_pur_20/lr_0.1_init_False_lambda_1.0_seed_45
INFO - main_bpda_eot.py - 2025-10-12 21:09:48,844 - Using args: Namespace(log='logs/CIFAR10/pgd_eot/l-1_512x1_it_20_eot_150_20/model_opt_method_aaopt_total_1_forward_0.25_pur_20/lr_0.1_init_False_lambda_1.0_seed_45', config='defalt.yml', seed=45, data_seed=['45'], verbose='info', dataset='CIFAR10', batch_size=8, clf_net='wideresnet-28-10', subset_size=512, purify_iter=20, apprx_iter=1, purify_model='opt', purify_method='aaopt', total_steps=1, forward_steps=0.25, loss_lambda=1.0, lr=0.1, init=False, att_method='pgd_eot', att_lp_norm=-1, att_eps=0.031373, att_step=1, att_n_iter=20, att_alpha=0.00784313725490196, eot_defense_reps=150, eot_attack_reps=20, network_pkl='https://nvlabs-fi-cdn.nvidia.com/edm/pretrained/edm-cifar10-32x32-uncond-vp.pkl', sigma_min=None, sigma_max=None, sdiff_cons=0.25, ex_grad=1, no_stop_grad=0, diff_reversed=1, aa=0, seq_t=0, use_full_steps=0, sdiff_net='./pretrained_models/cifar10_score_DIFF_JOINT_wideresnet-28-10_', use_aa_rand=0, device=device(type='cuda', index=0))
Files already downloaded and verified
using cifar10 wideresnet-28-10...
=> loading cifar10-diffusion checkpoint from 'https://nvlabs-fi-cdn.nvidia.com/edm/pretrained/edm-cifar10-32x32-uncond-vp.pkl'
loading perturbation model from provided path:  ./pretrained_models/cifar10_score_DIFF_JOINT_wideresnet-28-10_
perturbation model loaded
EPS:  0.031373
SDIFF:  0.25
BPDA_EOT config: {'eot_defense_ave': 'logits', 'eot_attack_ave': 'logits', 'eot_defense_reps': 150, 'eot_attack_reps': 20, 'adv_steps': 20, 'adv_norm': 'l_inf', 'adv_eps': 0.031373, 'adv_eta': 0.00784325, 'log_freq': 10}
BPDA_EOT tag: True
  0%|          | 0/64 [00:00<?, ?it/s]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 1-th batch in attack_all
  2%|▏         | 1/64 [01:19<1:23:48, 79.82s/it]Baseline: 6 of 8
Attack 0 of 20   Batch defended: 6 of 8
Attack 1 of 20   Batch defended: 6 of 8
Attack 10 of 20   Batch defended: 6 of 8
Attack 20 of 20   Batch defended: 6 of 8
finished 2-th batch in attack_all
  3%|▎         | 2/64 [02:38<1:21:44, 79.10s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 6 of 8
Attack 1 of 20   Batch defended: 6 of 8
Attack 10 of 20   Batch defended: 6 of 8
Attack 20 of 20   Batch defended: 6 of 8
finished 3-th batch in attack_all
  5%|▍         | 3/64 [03:57<1:20:11, 78.88s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 6 of 8
Attack 1 of 20   Batch defended: 6 of 8
Attack 10 of 20   Batch defended: 6 of 8
Attack 20 of 20   Batch defended: 6 of 8
finished 4-th batch in attack_all
  6%|▋         | 4/64 [05:18<1:20:01, 80.02s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 5-th batch in attack_all
  8%|▊         | 5/64 [06:31<1:16:00, 77.30s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 6-th batch in attack_all
  9%|▉         | 6/64 [07:43<1:13:08, 75.66s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 7-th batch in attack_all
 11%|█         | 7/64 [08:59<1:11:50, 75.63s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 8-th batch in attack_all
 12%|█▎        | 8/64 [10:27<1:14:13, 79.53s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 9-th batch in attack_all
 14%|█▍        | 9/64 [11:42<1:11:45, 78.29s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 10-th batch in attack_all
 16%|█▌        | 10/64 [12:58<1:09:41, 77.44s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 11-th batch in attack_all
 17%|█▋        | 11/64 [14:13<1:07:53, 76.86s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 12-th batch in attack_all
 19%|█▉        | 12/64 [15:26<1:05:27, 75.53s/it]Baseline: 6 of 8
Attack 0 of 20   Batch defended: 6 of 8
Attack 1 of 20   Batch defended: 6 of 8
Attack 10 of 20   Batch defended: 6 of 8
Attack 20 of 20   Batch defended: 6 of 8
finished 13-th batch in attack_all
 20%|██        | 13/64 [17:00<1:08:58, 81.15s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 6 of 8
Attack 20 of 20   Batch defended: 6 of 8
finished 14-th batch in attack_all
 22%|██▏       | 14/64 [18:22<1:07:46, 81.33s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 15-th batch in attack_all
 23%|██▎       | 15/64 [19:37<1:05:00, 79.60s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 16-th batch in attack_all
 25%|██▌       | 16/64 [21:02<1:04:56, 81.17s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 6 of 8
Attack 1 of 20   Batch defended: 6 of 8
Attack 10 of 20   Batch defended: 6 of 8
Attack 20 of 20   Batch defended: 6 of 8
finished 17-th batch in attack_all
 27%|██▋       | 17/64 [22:21<1:02:59, 80.41s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 18-th batch in attack_all
 28%|██▊       | 18/64 [23:36<1:00:31, 78.96s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 19-th batch in attack_all
 30%|██▉       | 19/64 [24:52<58:27, 77.94s/it]  Baseline: 4 of 8
Attack 0 of 20   Batch defended: 4 of 8
Attack 1 of 20   Batch defended: 4 of 8
Attack 10 of 20   Batch defended: 4 of 8
Attack 20 of 20   Batch defended: 4 of 8
finished 20-th batch in attack_all
 31%|███▏      | 20/64 [26:17<58:40, 80.01s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 21-th batch in attack_all
 33%|███▎      | 21/64 [27:29<55:43, 77.75s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 22-th batch in attack_all
 34%|███▍      | 22/64 [28:57<56:33, 80.80s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 6 of 8
Attack 20 of 20   Batch defended: 6 of 8
finished 23-th batch in attack_all
 36%|███▌      | 23/64 [30:19<55:24, 81.08s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 24-th batch in attack_all
 38%|███▊      | 24/64 [31:50<56:01, 84.04s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 25-th batch in attack_all
 39%|███▉      | 25/64 [33:02<52:22, 80.58s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 26-th batch in attack_all
 41%|████      | 26/64 [34:18<50:04, 79.07s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 27-th batch in attack_all
 42%|████▏     | 27/64 [35:40<49:15, 79.87s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 28-th batch in attack_all
 44%|████▍     | 28/64 [36:58<47:41, 79.49s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 29-th batch in attack_all
 45%|████▌     | 29/64 [38:17<46:13, 79.23s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 30-th batch in attack_all
 47%|████▋     | 30/64 [40:03<49:30, 87.37s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 6 of 8
Attack 1 of 20   Batch defended: 6 of 8
Attack 10 of 20   Batch defended: 6 of 8
Attack 20 of 20   Batch defended: 6 of 8
finished 31-th batch in attack_all
 48%|████▊     | 31/64 [41:22<46:36, 84.75s/it]Baseline: 5 of 8
Attack 0 of 20   Batch defended: 5 of 8
Attack 1 of 20   Batch defended: 5 of 8
Attack 10 of 20   Batch defended: 5 of 8
Attack 20 of 20   Batch defended: 5 of 8
finished 32-th batch in attack_all
 50%|█████     | 32/64 [42:43<44:42, 83.84s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 33-th batch in attack_all
 52%|█████▏    | 33/64 [43:59<42:01, 81.35s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 34-th batch in attack_all
 53%|█████▎    | 34/64 [45:18<40:15, 80.53s/it]Baseline: 6 of 8
Attack 0 of 20   Batch defended: 6 of 8
Attack 1 of 20   Batch defended: 5 of 8
Attack 10 of 20   Batch defended: 5 of 8
Attack 20 of 20   Batch defended: 5 of 8
finished 35-th batch in attack_all
 55%|█████▍    | 35/64 [46:39<39:05, 80.88s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 36-th batch in attack_all
 56%|█████▋    | 36/64 [47:55<36:59, 79.27s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 37-th batch in attack_all
 58%|█████▊    | 37/64 [49:07<34:45, 77.23s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 38-th batch in attack_all
 59%|█████▉    | 38/64 [50:20<32:50, 75.81s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 39-th batch in attack_all
 61%|██████    | 39/64 [51:35<31:33, 75.73s/it]Baseline: 6 of 8
Attack 0 of 20   Batch defended: 6 of 8
Attack 1 of 20   Batch defended: 6 of 8
Attack 10 of 20   Batch defended: 3 of 8
Attack 20 of 20   Batch defended: 3 of 8
finished 40-th batch in attack_all
 62%|██████▎   | 40/64 [53:31<35:04, 87.68s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 41-th batch in attack_all
 64%|██████▍   | 41/64 [54:46<32:13, 84.04s/it]Baseline: 6 of 8
Attack 0 of 20   Batch defended: 6 of 8
Attack 1 of 20   Batch defended: 6 of 8
Attack 10 of 20   Batch defended: 6 of 8
Attack 20 of 20   Batch defended: 6 of 8
finished 42-th batch in attack_all
 66%|██████▌   | 42/64 [56:08<30:33, 83.35s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 43-th batch in attack_all
 67%|██████▋   | 43/64 [57:27<28:40, 81.93s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 44-th batch in attack_all
 69%|██████▉   | 44/64 [58:42<26:40, 80.01s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 45-th batch in attack_all
 70%|███████   | 45/64 [59:55<24:37, 77.74s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 46-th batch in attack_all
 72%|███████▏  | 46/64 [1:01:16<23:40, 78.93s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 47-th batch in attack_all
 73%|███████▎  | 47/64 [1:02:29<21:48, 76.98s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 48-th batch in attack_all
 75%|███████▌  | 48/64 [1:03:48<20:39, 77.48s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 49-th batch in attack_all
 77%|███████▋  | 49/64 [1:05:00<18:59, 75.98s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 50-th batch in attack_all
 78%|███████▊  | 50/64 [1:06:19<17:54, 76.77s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 51-th batch in attack_all
 80%|███████▉  | 51/64 [1:07:34<16:33, 76.40s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 52-th batch in attack_all
 81%|████████▏ | 52/64 [1:08:47<15:02, 75.22s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 6 of 8
Attack 1 of 20   Batch defended: 6 of 8
Attack 10 of 20   Batch defended: 6 of 8
Attack 20 of 20   Batch defended: 6 of 8
finished 53-th batch in attack_all
 83%|████████▎ | 53/64 [1:10:11<14:18, 78.08s/it]Baseline: 6 of 8
Attack 0 of 20   Batch defended: 6 of 8
Attack 1 of 20   Batch defended: 6 of 8
Attack 10 of 20   Batch defended: 6 of 8
Attack 20 of 20   Batch defended: 6 of 8
finished 54-th batch in attack_all
 84%|████████▍ | 54/64 [1:11:30<13:02, 78.24s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 55-th batch in attack_all
 86%|████████▌ | 55/64 [1:12:49<11:45, 78.36s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 6 of 8
Attack 10 of 20   Batch defended: 6 of 8
Attack 20 of 20   Batch defended: 6 of 8
finished 56-th batch in attack_all
 88%|████████▊ | 56/64 [1:14:10<10:34, 79.36s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 6 of 8
Attack 20 of 20   Batch defended: 6 of 8
finished 57-th batch in attack_all
 89%|████████▉ | 57/64 [1:15:38<09:33, 81.91s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 6 of 8
Attack 20 of 20   Batch defended: 6 of 8
finished 58-th batch in attack_all
 91%|█████████ | 58/64 [1:17:15<08:38, 86.46s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 59-th batch in attack_all
 92%|█████████▏| 59/64 [1:18:28<06:51, 82.27s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 6 of 8
Attack 1 of 20   Batch defended: 6 of 8
Attack 10 of 20   Batch defended: 6 of 8
Attack 20 of 20   Batch defended: 6 of 8
finished 60-th batch in attack_all
 94%|█████████▍| 60/64 [1:19:50<05:28, 82.15s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 61-th batch in attack_all
 95%|█████████▌| 61/64 [1:21:18<04:11, 83.86s/it]Baseline: 8 of 8
Attack 0 of 20   Batch defended: 8 of 8
Attack 1 of 20   Batch defended: 8 of 8
Attack 10 of 20   Batch defended: 8 of 8
Attack 20 of 20   Batch defended: 8 of 8
finished 62-th batch in attack_all
 97%|█████████▋| 62/64 [1:22:30<02:40, 80.44s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 6 of 8
Attack 20 of 20   Batch defended: 6 of 8
finished 63-th batch in attack_all
 98%|█████████▊| 63/64 [1:23:55<01:21, 81.74s/it]Baseline: 7 of 8
Attack 0 of 20   Batch defended: 7 of 8
Attack 1 of 20   Batch defended: 7 of 8
Attack 10 of 20   Batch defended: 7 of 8
Attack 20 of 20   Batch defended: 7 of 8
finished 64-th batch in attack_all
100%|██████████| 64/64 [1:25:26<00:00, 84.50s/it]100%|██████████| 64/64 [1:25:26<00:00, 80.10s/it]
Rank: 0, x_adv shape: torch.Size([512, 3, 32, 32])
INFO - main_bpda_eot.py - 2025-10-12 22:35:17,968 - Rank:0
INFO - main_bpda_eot.py - 2025-10-12 22:35:17,969 - standard accuracy: 0.916015625
INFO - main_bpda_eot.py - 2025-10-12 22:35:17,969 - robust accuracy: 0.86328125
INFO - main_bpda_eot.py - 2025-10-12 22:35:17,969 - All gpus
INFO - main_bpda_eot.py - 2025-10-12 22:35:17,969 - standard accuracy: 0.916015625
INFO - main_bpda_eot.py - 2025-10-12 22:35:17,969 - robust accuracy: 0.86328125
INFO - main_bpda_eot.py - 2025-10-12 22:35:17,969 - time elapsed: 5126.34s
Done with sdiff_cons=0.25
 
Completed outer loop iteration: 5 (seed=45)
===============================
